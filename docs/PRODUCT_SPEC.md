# Продуктовая спецификация: AI ROI Calculator

## 1. Обзор продукта

**AI ROI Calculator** — веб-сервис, позволяющий оценить экономическую эффективность внедрения ИИ-решения в бизнес-процесс. Пользователь описывает текущий процесс (AS-IS) и целевой (TO-BE), ошибки, затраты на внедрение — и получает расчёт ROI с графиками динамики окупаемости.

### Ключевые ценности
- **Структурированный подход** — пошаговое описание процесса с конкретными метриками
- **Наглядность** — графики окупаемости, точка безубыточности, динамика экономии
- **Готовые шаблоны** — библиотека предзаполненных расчётов для типовых процессов
- **Без регистрации** — мгновенный доступ к расчёту

---

## 2. Роли пользователей

### 2.1 Обычный пользователь
- Создаёт новый расчёт с нуля
- Загружает расчёт из библиотеки шаблонов
- Заполняет/редактирует все блоки расчёта
- Просматривает результаты и графики
- Может вернуться к ранее проделанному расчёту (по уникальной ссылке)

### 2.2 Администратор
- Доступ по секретной ссылке (например, `/admin/{secret_token}`)
- Создаёт и редактирует шаблоны в библиотеке
- Шаблоны содержат заполненные процессы, ошибки — но без стоимостей (пользователь подставляет свои цены)
- Может удалять и архивировать шаблоны

---

## 3. Пользовательский flow

```
Главная страница
├── [Новый расчёт] → Переход к пустому калькулятору
├── [Загрузить из библиотеки] → Список шаблонов → Выбор → Калькулятор с предзаполненными данными
└── [Мои расчёты] → Список ранее сохранённых → Выбор → Калькулятор с данными

Калькулятор (основной экран):
├── Шаг 1: Описание процесса AS-IS (таблица этапов)
├── Шаг 2: Описание процесса TO-BE (таблица этапов)
├── Шаг 3: Ошибки AS-IS (таблица ошибок)
├── Шаг 4: Ошибки TO-BE (таблица ошибок)
├── Шаг 5: Динамика раскатки (выбор модели + параметры)
├── Шаг 6: CAPEX (таблица единовременных затрат)
├── Шаг 7: OPEX (таблица ежемесячных затрат)
└── Шаг 8: Результаты — ROI, графики, ключевые метрики
```

---

## 4. Блоки расчёта

### 4.1 Процесс AS-IS (текущее состояние)

Таблица с динамическим добавлением строк и перетаскиванием для изменения порядка:

| Поле | Тип | Описание |
|------|-----|----------|
| Этап | string | Название шага процесса |
| Сотрудник | string | Роль/должность исполнителя |
| Цена часа | number (₽) | Стоимость часа работы сотрудника |
| Время в часах | number | Трудозатраты на этап |
| Календарный срок в днях | number | Длительность этапа в календарных днях |
| Стоимость шага | computed (₽) | = Цена часа × Время в часах |
| Доля в выполнении | number (0-1) | Какая доля случаев проходит через этот этап |
| Удельное время | computed | = Время в часах × Доля в выполнении |
| Удельная стоимость | computed (₽) | = Стоимость шага × Доля в выполнении |

**Итого по процессу:**
- Суммарное удельное время
- Суммарная удельная стоимость
- Суммарный календарный срок

### 4.2 Процесс TO-BE (целевое состояние с ИИ)

Структура полностью аналогична AS-IS (включая перетаскивание строк). Кнопка «Скопировать из AS-IS» копирует все строки AS-IS в TO-BE одним кликом.

### 4.3 Ошибки AS-IS

Таблица ошибок текущего процесса с перетаскиванием для изменения порядка:

| Поле | Тип | Описание |
|------|-----|----------|
| Тип ошибки | string | Описание ошибки |
| Этап процесса | string | На каком этапе возникает |
| Частота (доля случаев) | number (0-1) | Как часто возникает ошибка |
| Стоимость исправления | number (₽) | Сколько стоит исправить одну ошибку |
| Время на исправление (ч) | number | Время на исправление одной ошибки |
| Удельная стоимость ошибки | computed (₽) | = Частота × Стоимость исправления |
| Удельное время ошибки | computed | = Частота × Время на исправление |

### 4.4 Ошибки TO-BE

Аналогично ошибкам AS-IS (включая перетаскивание строк). Кнопка «Скопировать из AS-IS» копирует все строки AS-IS в TO-BE одним кликом — с учётом того, что ИИ снижает частоту и/или стоимость ошибок.

### 4.5 Динамика раскатки

Определяет, как быстро ИИ-решение внедряется в операции.

| Поле | Тип | Описание |
|------|-----|----------|
| Модель раскатки | enum | `linear` / `s_curve` / `instant` |
| Срок полной раскатки (мес.) | number | За сколько месяцев достигается 100% (не для instant) |
| Целевая доля операций | number (0-1) | Максимальная доля операций с ИИ (может быть < 100%) |
| Объём операций в месяц | number | Количество выполнений процесса в месяц |

**Модели:**
- **Моментальная (instant):** 100% целевой доли с первого месяца
- **Линейная (linear):** равномерный рост от 0% до целевой доли за указанный срок
- **S-кривая (s_curve):** медленный старт → быстрый рост → замедление при приближении к целевой доле

### 4.6 CAPEX (единовременные затраты)

Таблица с динамическим добавлением строк:

| Поле | Тип | Описание |
|------|-----|----------|
| Статья затрат | string | Описание (разработка, лицензия, оборудование...) |
| Стоимость | number (₽) | Сумма |
| Комментарий | string | Пояснение (опционально) |

### 4.7 OPEX (ежемесячные затраты)

| Поле | Тип | Описание |
|------|-----|----------|
| Статья затрат | string | Описание (подписка API, поддержка, инфраструктура...) |
| Стоимость в месяц | number (₽) | Сумма в месяц |
| Комментарий | string | Пояснение (опционально) |

---

## 5. Расчёт ROI

### 5.1 Базовые метрики

```
Экономия на процессе (за 1 операцию) =
  Удельная стоимость AS-IS − Удельная стоимость TO-BE

Экономия на ошибках (за 1 операцию) =
  Σ Удельная стоимость ошибок AS-IS − Σ Удельная стоимость ошибок TO-BE

Общая экономия за 1 операцию =
  Экономия на процессе + Экономия на ошибках

Экономия времени за 1 операцию =
  (Удельное время AS-IS + Удельное время ошибок AS-IS)
  − (Удельное время TO-BE + Удельное время ошибок TO-BE)
```

### 5.2 Помесячный расчёт

```
Для каждого месяца t:

  Доля_раскатки(t) = f(модель_раскатки, t)
  Операций_с_ИИ(t) = Объём_операций × Доля_раскатки(t)

  Выгода(t) = Операций_с_ИИ(t) × Общая_экономия_за_операцию
  Затраты_OPEX(t) = Σ OPEX_статей

  Чистая_выгода(t) = Выгода(t) − Затраты_OPEX(t)

Накопленная_выгода(T) = Σ Чистая_выгода(t) для t от 1 до T
Накопленные_затраты(T) = CAPEX + Σ Затраты_OPEX(t) для t от 1 до T

ROI(T) = (Накопленная_выгода(T) − CAPEX) / (CAPEX + Накопленные_OPEX(T)) × 100%
```

### 5.3 Точка окупаемости

Месяц `T`, в котором `Накопленная_чистая_выгода(T) ≥ CAPEX`

### 5.4 Мультипликаторы производительности

Показывают, во сколько раз улучшился процесс после внедрения ИИ. Вычисляются на основе данных шагов AS-IS и TO-BE:

```
Рост производительности (человеко-часы) =
  Удельное время AS-IS / Удельное время TO-BE

Снижение стоимости =
  Удельная стоимость AS-IS / Удельная стоимость TO-BE

Ускорение процесса (календарные дни) =
  Суммарный срок AS-IS / Суммарный срок TO-BE
  (показывается только если в обеих версиях заполнено поле «Дни»)
```

Отображаются на экране результатов в блоке «Эффект автоматизации» с указанием значений AS-IS и TO-BE.

---

## 6. Графики

### 6.1 Динамика окупаемости (главный график)
- **Тип:** Area chart
- **Ось X:** Месяцы (1..24 или настраиваемый горизонт)
- **Линия 1:** Накопленная выгода (зелёная область)
- **Линия 2:** Накопленные затраты (красная область)
- **Маркер:** Точка окупаемости (вертикальная линия + подпись)
- **Tooltip:** Детали при наведении на месяц

### 6.2 Помесячная экономия
- **Тип:** Stacked bar chart
- **Ось X:** Месяцы
- **Столбец 1:** Экономия на процессе (синий)
- **Столбец 2:** Экономия на ошибках (зелёный)
- **Столбец 3:** OPEX затраты (красный, отрицательный)
- **Линия:** Чистая выгода за месяц

### 6.3 Кривая раскатки
- **Тип:** Line chart
- **Ось X:** Месяцы
- **Ось Y:** % операций с ИИ
- **Показывает:** Выбранную модель раскатки (linear / s-curve / instant)

### 6.4 Сравнение AS-IS vs TO-BE
- **Тип:** Horizontal bar chart
- **Сравнение:** Стоимость и время на операцию — до и после
- **Включает:** Стоимость процесса + стоимость ошибок

---

## 7. Библиотека шаблонов

### Структура шаблона
- Название (например, «Обработка входящих заявок», «Проверка документов»)
- Описание
- Отрасль / категория
- Предзаполненные данные:
  - Этапы процесса AS-IS (с временем и долями, без часовой ставки)
  - Этапы процесса TO-BE (с временем и долями, без часовой ставки)
  - Типы ошибок AS-IS (с частотой, без стоимостей)
  - Типы ошибок TO-BE (с частотой, без стоимостей)
  - Статьи CAPEX (без сумм)
  - Статьи OPEX (без сумм)
  - Модель раскатки по умолчанию (модель, срок, целевая доля)

### При загрузке шаблона
Пользователь получает предзаполненный расчёт с ориентировочными временными нормативами и долями выполнения. Нужно подставить только часовые ставки сотрудников и объём операций.

---

## 8. Сохранение и доступ к расчётам

### Автосохранение
- Расчёт автоматически сохраняется при каждом изменении
- Каждый расчёт получает уникальный ID (UUID)
- URL формат: `/{calculation_id}`

### История расчётов
- Список всех расчётов хранится в localStorage браузера (список ID)
- На странице «Мои расчёты» отображаются все расчёты пользователя
- Для каждого расчёта показаны: название, дата создания, дата изменения, статус заполнения

### Шаринг
- Любой расчёт доступен по прямой ссылке (по ID)
- Ссылку можно скопировать и отправить коллеге

---

## 9. Экраны приложения

### 9.1 Главная страница
- Заголовок и краткое описание сервиса
- Три CTA-кнопки: «Новый расчёт», «Из библиотеки», «Мои расчёты»
- Краткое описание что делает сервис

### 9.2 Калькулятор
- Навигация по шагам (stepper/tabs сверху)
- Активный шаг отображает соответствующую таблицу или форму
- Кнопки «Назад» / «Далее» между шагами
- На шаге «Результаты» — ключевые цифры + графики:
  - KPI-карточки: ROI, точка окупаемости, экономия за год, экономия за операцию
  - Блок «Эффект автоматизации»: во сколько раз выросла производительность, снизилась стоимость и ускорился процесс (см. п. 5.4)
  - Детализация экономии по категориям (процесс / ошибки)
  - Четыре графика: динамика окупаемости, помесячная экономия, кривая раскатки, сравнение AS-IS vs TO-BE
- Кнопка «Скопировать ссылку» для шаринга расчёта
- Название расчёта (редактируемое)
- Перетаскивание строк (drag & drop) для изменения порядка этапов и ошибок
- Кнопка «Скопировать из AS-IS» на шагах TO-BE (процесс и ошибки)

### 9.3 Библиотека шаблонов
- Карточки шаблонов с названием, описанием, отраслью
- Фильтр по отрасли/категории
- При клике — предпросмотр шаблона и кнопка «Использовать»

### 9.4 Мои расчёты
- Список расчётов из localStorage
- Сортировка по дате
- Удаление расчёта из списка

### 9.5 Админ-панель (`/admin/{token}`)
- CRUD шаблонов
- Форма аналогична калькулятору, но без стоимостных полей
- Список всех шаблонов с возможностью редактирования / удаления / публикации

---

## 10. Нефункциональные требования

- **Производительность:** расчёты выполняются на клиенте (мгновенно)
- **Адаптивность:** корректно работает на десктопе и планшете (мобайл — low priority)
- **Доступность:** базовая — контрастность, фокус на элементах, семантика
- **Безопасность:** админ-токен хранится в env-переменной, не хардкодится
